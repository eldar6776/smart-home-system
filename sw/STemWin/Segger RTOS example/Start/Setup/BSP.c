/*********************************************************************
*                SEGGER Microcontroller GmbH & Co. KG                *
*                        The Embedded Experts                        *
**********************************************************************
*                                                                    *
*       (c) 2003 - 2016  SEGGER Microcontroller GmbH & Co. KG        *
*                                                                    *
*       www.segger.com     Support: support@segger.com               *
*                                                                    *
**********************************************************************
----------------------------------------------------------------------
File    : BSP.c
Purpose : BSP for STM32746G Discovery eval board
--------  END-OF-HEADER  ---------------------------------------------
*/

#include "BSP.h"
#include "RTOS.h"
#include "stm32f7xx.h"

/*********************************************************************
*
*       Defines
*
**********************************************************************
*/

/*********************************************************************
*
*       Typedefs
*
**********************************************************************
*/

/*********************************************************************
*
*       Static data
*
**********************************************************************
*/

/*********************************************************************
*
*       Static functions
*
**********************************************************************
*/

/*********************************************************************
*
*       Global functions
*
**********************************************************************
*/

/*********************************************************************
*
*       BSP_Init()
*/
void BSP_Init(void) {
  RCC->AHB1ENR |= 0
               | (RCC_AHB1ENR_GPIOIEN)  // GPIOIEN: IO port I clock enable
               ;
  //
  // 
  // LED
  //
  GPIOI->MODER    =   (GPIOI->MODER  & ~(3UL  <<  2)) | (1UL  <<  2);
  GPIOI->OTYPER  &=  ~(1UL  <<  1);
  GPIOI->OSPEEDR |=   (3UL  <<  2);
  GPIOI->PUPDR    =   (GPIOI->PUPDR & ~(3UL  <<  2)) | (1UL << 2) ;
}

/*********************************************************************
*
*       BSP_SetLED()
*/
void BSP_SetLED(int Index) {
  GPIOI->BSRR = (0x10000uL << 1);         // Switch on LED
  (void) Index;
}

/*********************************************************************
*
*       BSP_ClrLED()
*/
void BSP_ClrLED(int Index) {
  GPIOI->BSRR = (0x000001uL << 1);         // Switch on LED
  (void) Index;
}

/*********************************************************************
*
*       BSP_ToggleLED()
*/
void BSP_ToggleLED(int Index) {
  (void) Index;
  if (GPIOI->ODR & (1uL << 1)) {  // LED is switched off
    BSP_SetLED(1);
  } else {
    BSP_ClrLED(1);
  }
}

/****** End Of File *************************************************/
